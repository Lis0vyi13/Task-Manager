import{j as s,V as D,W as L,X as E,Y as O,Z as z,_ as F,r as n,h as w,L as M,m as q,w as W,$ as R,B as V,o as b,a0 as U,E as Y,A as S,M as H,k as K,a1 as G,P as Q,a2 as X,a as I,a3 as Z,t as J,a4 as ss}from"./index-CrHAFnCA.js";import{T as es}from"./index-wf3Z-fMi.js";import{P as ts,S as as}from"./index-D90kwFJU.js";import{T as cs,M as ns,P as os}from"./transformToInputDateType-9qsVDyqT.js";import{Q as ls}from"./index-DO2vfCeJ.js";import{S as is,I as rs}from"./index-DgDDtzeS.js";const ds="_icon_zorh8_1",ms="_iconStarted_zorh8_13",_s="_iconCompleted_zorh8_17",us="_iconInProgress_zorh8_21",hs="_iconBug_zorh8_25",xs="_iconCommented_zorh8_30",x={icon:ds,iconStarted:ms,iconCompleted:_s,iconInProgress:us,iconBug:hs,iconCommented:xs},ks={commented:s.jsx("div",{className:`${x.icon} ${x.iconCommented}`,children:s.jsx(D,{})}),started:s.jsx("div",{className:`${x.icon} ${x.iconStarted}`,children:s.jsx(L,{})}),assigned:s.jsx("div",{className:`${x.icon} ${x.iconAssigned}`,children:s.jsx(E,{})}),bug:s.jsx("div",{className:`${x.icon} ${x.iconBug}`,children:s.jsx(O,{size:24})}),completed:s.jsx("div",{className:`${x.icon} ${x.iconCompleted}`,children:s.jsx(z,{size:24})}),"in progress":s.jsx("div",{className:`${x.icon} ${x.iconInProgress}`,children:s.jsx(F,{size:16})})},ps="_activity_9dkdd_1",js="_iconBlock_9dkdd_6",gs="_icon_9dkdd_6",bs="_lineBlock_9dkdd_19",Ns="_line_9dkdd_19",vs="_info_9dkdd_29",fs="_username_9dkdd_33",Bs="_typeDateBlock_9dkdd_39",Ts="_type_9dkdd_39",ys="_date_9dkdd_51",Ms="_activityText_9dkdd_57",j={activity:ps,iconBlock:js,icon:gs,lineBlock:bs,line:Ns,info:vs,username:fs,typeDateBlock:Bs,type:Ts,date:ys,activityText:Ms},Cs=n.memo(({activity:e})=>{const t=n.useMemo(()=>{var a;return(a=w.users.find(c=>c._id===e.by))==null?void 0:a.name},[e.by]);return s.jsxs("div",{className:j.activity,children:[s.jsxs("div",{className:j.iconBlock,children:[s.jsx("div",{className:j.icon,children:ks[e.type]}),s.jsx("div",{className:j.lineBlock,children:s.jsx("div",{className:j.line})})]}),s.jsxs("div",{className:j.info,children:[s.jsx("h3",{className:j.username,children:t||s.jsx(M,{})}),s.jsxs("div",{className:j.typeDateBlock,children:[s.jsx("span",{className:j.type,children:e.type}),s.jsx("span",{className:j.date,children:q(e.date).fromNow()})]}),s.jsx("h1",{className:j.activityText,children:e.activity})]})]})}),Ss="_addActivityForm_5m6dm_1",Is="_label_5m6dm_5",As="_selectBlock_5m6dm_10",$s="_select_5m6dm_10",Ps="_textareaBlock_5m6dm_39",Ds="_textarea_5m6dm_39",Ls="_submitButton_5m6dm_91",Es="_errorText_5m6dm_98",g={addActivityForm:Ss,label:Is,selectBlock:As,select:$s,textareaBlock:Ps,textarea:Ds,submitButton:Ls,errorText:Es},Os=()=>{const{register:e,handleSubmit:t,reset:a,formState:{errors:c}}=W(),l=o=>{console.log(o),a()};return s.jsxs("form",{onSubmit:t(l),className:g.addActivityForm,children:[s.jsxs("div",{className:g.selectBlock,children:[s.jsx("p",{className:g.label,children:"Type:"}),s.jsx("select",{id:"type",...e("type",{required:!0}),className:g.select,children:R.map(o=>s.jsx("option",{value:o,children:o},o))}),c.type&&s.jsx("p",{className:g.errorText,children:"Please select a type."})]}),(c==null?void 0:c.type)&&s.jsx("p",{className:g.errorText,children:"Please select a type."}),s.jsxs("div",{className:g.textareaBlock,children:[s.jsx("textarea",{placeholder:"Type...",className:g.textarea,...e("activity",{required:!0}),name:"activity"}),c.activity&&s.jsx("p",{className:g.errorText,children:"Please enter an activity."})]}),s.jsx(V,{className:g.submitButton,type:"submit",children:"Submit"})]})},zs="_activitiesWrapper_9deir_1",Fs="_title_9deir_14",ws="_activities_9deir_1",qs="_left_9deir_25",Ws="_right_9deir_29",v={activitiesWrapper:zs,title:Fs,activities:ws,left:qs,right:Ws},Rs=({task:e})=>{var t;return s.jsxs("section",{className:v.activitiesWrapper,children:[s.jsxs("article",{className:v.left,children:[s.jsx(b,{className:v.title,children:"Activities"}),s.jsx("div",{className:v.activities,children:((t=e==null?void 0:e.activities)==null?void 0:t.length)>0?e.activities.map(a=>s.jsx(Cs,{activity:a},a._id)):"No activities added"})]}),s.jsxs("article",{className:v.right,children:[s.jsx(b,{className:v.title,children:"Add activity"}),s.jsx(Os,{})]})]})};function Vs(e){let t,a,c=0;return e<50?(t=255,a=Math.round(255*(e/50))):(t=Math.round(255*(1-(e-50)/50)),a=255),{background:`rgb(${t}, ${a}, ${c})`,isLight:(t+a+c)/3>128}}const Us=({task:e})=>{const{subTasks:t}=n.useMemo(()=>e,[e]),a=n.useMemo(()=>t.filter(o=>o.done).length,[t]),c=n.useMemo(()=>a>0?Math.round(a/t.length*100):0,[a,t.length]);return{progressColor:n.useMemo(()=>Vs(c),[c]),subtasksProgress:c,subTasks:t}},Ys="_status_kt5py_1",Hs="_uppercase_kt5py_7",Ks={status:Ys,uppercase:Hs},Gs=({priority:e})=>{const t=n.useMemo(()=>U[e],[e]),a=n.useMemo(()=>e==="normal"?"1px solid #000":"unset",[e]);return s.jsx("div",{style:{backgroundColor:t,border:a},className:Ks.status,children:s.jsx(ts,{style:{textTransform:"uppercase",fontWeight:"bold"},priority:e,withAddition:!0})})},Qs="_avatar_mgm8r_1",Xs="_info_mgm8r_12",Zs="_userInfo_mgm8r_18",Js="_name_mgm8r_25",se="_role_mgm8r_29",ee="_member_mgm8r_33",N={avatar:Qs,info:Xs,userInfo:Zs,name:Js,role:se,member:ee},te=({user:e})=>s.jsxs("div",{className:N.member,children:[s.jsx(cs,{...e,className:N.avatar,avatarClassName:N.avatar,infoClassName:N.info,team:[e]}),s.jsxs("div",{className:N.userInfo,children:[s.jsx("p",{className:N.name,children:e.name}),s.jsx("span",{className:N.role,children:e.role})]})]}),ae=()=>{const e=n.useCallback(()=>{},[]),{isOpened:t,isClosing:a,handleToggle:c,handleClose:l}=Y(),[o,h,u]=S({setItem:()=>{}}),[k,p,m]=S({setItem:()=>{}}),d=n.useMemo(()=>[[{icon:{Icon:H,color:"#000"},title:"Edit",permission:!1,onClick:h}],[{icon:{Icon:K,color:"red"},title:"Delete",permission:!1,onClick:p}]],[p,h]);return{doneHandler:e,isOpened:t,isClosing:a,handleToggle:c,handleClose:l,OPTIONS:d,isDeleteModalOpen:k,closeDeleteModal:m,isEditModalOpen:o,closeEditModal:u}},ce="_subtask_pcmf1_1",ne="_subtaskIcon_pcmf1_6",oe="_header_pcmf1_21",le="_date_pcmf1_28",ie="_tags_pcmf1_34",re="_tag_pcmf1_34",de="_doneTag_pcmf1_50",me="_subtaskInfo_pcmf1_55",_e="_main_pcmf1_60",ue="_done_pcmf1_50",he="_undone_pcmf1_73",xe="_button_pcmf1_77",i={subtask:ce,subtaskIcon:ne,header:oe,date:le,tags:ie,tag:re,doneTag:de,subtaskInfo:me,main:_e,done:ue,undone:he,button:xe},ke=({title:e,date:t,tag:a,done:c})=>{const{doneHandler:l,isOpened:o,isClosing:h,handleToggle:u,handleClose:k,OPTIONS:p,isDeleteModalOpen:m,closeDeleteModal:d,isEditModalOpen:B,closeEditModal:A}=ae(),$=n.useMemo(()=>({title:e,date:t,tag:a}),[t,a,e]);return s.jsxs("div",{className:i.subtask,children:[s.jsx("div",{className:i.subtaskIcon,children:s.jsx(G,{color:"rgb(124,58,237)",size:26})}),s.jsxs("div",{className:i.subtaskInfo,children:[s.jsxs("header",{className:i.header,children:[s.jsx("span",{className:i.date,children:new Date(t).toDateString()}),s.jsxs("div",{className:i.tags,children:[s.jsx("span",{className:i.tag,children:a}),c&&s.jsx("span",{className:`${i.doneTag} ${i.tag}`,children:"Done"})]})]}),s.jsxs("main",{className:i.main,children:[s.jsx("p",{className:i.subtaskTitle,children:e}),s.jsx("div",{className:i.more,children:s.jsx(ns,{onClick:u})}),o&&s.jsx(Q,{className:`${i.popup}`,isClosing:h,handleClose:k,children:p.map(C=>C.map((T,P)=>s.jsx(os,{disabled:T.permission,className:P+1===C.length?"divider":"",icon:T.icon,title:T.title,handleClose:k,onClick:T.onClick},T.title)))})]}),s.jsx("footer",{className:i.footer,children:s.jsx("button",{onClick:l,className:`${c?i.undone:i.done} ${i.button}`,children:c?"Mark as Undone":"Mark as Done"})}),B&&s.jsx(is,{changedValue:B,onClose:A,subtask:$}),m&&s.jsx(ls,{changedValue:m,onClose:d,type:"delete",text:"Are you sure to delete current subtask?"})]})]})},pe="_taskInfo_1n651_1",je="_priorityStageBlock_1n651_6",ge="_stageBlock_1n651_13",be="_stage_1n651_13",Ne="_createdAtBlock_1n651_24",ve="_createdAt_1n651_24",fe="_assetsSubTasksBlock_1n651_34",Be="_teamBlock_1n651_46",Te="_subtasksBlock_1n651_47",ye="_titleSecondary_1n651_51",Me="_memberBlock_1n651_57",Ce="_substasksTitle_1n651_62",Se="_subtasksProgress_1n651_68",Ie="_subtasks_1n651_47",r={taskInfo:pe,priorityStageBlock:je,stageBlock:ge,stage:be,createdAtBlock:Ne,createdAt:ve,assetsSubTasksBlock:fe,teamBlock:Be,subtasksBlock:Te,titleSecondary:ye,memberBlock:Me,substasksTitle:Ce,subtasksProgress:Se,subtasks:Ie},Ae=n.memo(({task:e})=>{const{progressColor:t,subtasksProgress:a,subTasks:c}=Us({task:e});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:r.taskInfo,children:[s.jsxs("div",{className:r.priorityStageBlock,children:[s.jsx(Gs,{priority:e.priority}),s.jsxs("div",{className:r.stageBlock,children:[s.jsx(as,{stage:e.stage}),s.jsx("span",{className:r.stage,children:e.stage})]})]}),s.jsx("div",{className:r.createdAtBlock,children:s.jsxs("span",{className:r.createdAt,children:["Created at: ",new Date(e.createdAt).toDateString()]})})]}),s.jsxs("div",{className:r.assetsSubTasksBlock,children:[s.jsxs("span",{children:["Assets: ",e.assets.length]}),s.jsx("span",{children:"|"}),s.jsxs("span",{children:["Sub-Tasks: ",e.subTasks.length]})]}),s.jsxs("div",{className:r.teamBlock,children:[s.jsx(b,{className:r.titleSecondary,children:"TASK TEAM"}),s.jsx("div",{className:r.team,children:e.team.map(l=>s.jsx("div",{className:r.memberBlock,children:s.jsx(te,{user:l})},l._id))})]}),s.jsxs("div",{className:r.subtasksBlock,children:[s.jsxs("div",{className:r.substasksTitle,children:[s.jsx(b,{className:r.titleSecondary,children:"Sub-tasks"}),s.jsx("div",{style:{background:t.background},className:r.subtasksProgress,children:s.jsxs("span",{style:{color:t.isLight?"#000":"#fff"},className:r.subtasksProgressValue,children:[a.toFixed(2),"%"]})})]}),s.jsx("div",{className:r.subtasks,children:c.map(l=>s.jsx(ke,{...l},l._id))})]})]})}),$e=({task:e})=>{const[t,a]=n.useState(null),[c,l]=n.useState(!0);n.useEffect(()=>{var u;if(e.assets&&e.assets.length>0){const k=(u=e==null?void 0:e.assets)==null?void 0:u.map(p=>new Promise(m=>{const d=new Image;d.src=p,d.onload=m,d.onerror=m}));Promise.all(k).then(()=>{l(!1)})}else l(!1)},[e.assets]);const o=n.useCallback(u=>{a(u)},[]),h=n.useCallback(()=>{a(null)},[]);return{selectedImage:t,loading:c,handleImageClick:o,handleCloseModal:h}},Pe="_title_dssre_1",De="_assetsBlock_dssre_6",Le="_assets_dssre_6",Ee="_assetsCenter_dssre_17",Oe="_noAssetsText_dssre_26",ze="_asset_dssre_6",Fe="_supportLinksBlock_dssre_41",we="_linksBlock_dssre_42",qe="_loader_dssre_46",We="_list_dssre_50",Re="_link_dssre_42",_={title:Pe,assetsBlock:De,assets:Le,assetsCenter:Ee,noAssetsText:Oe,asset:ze,supportLinksBlock:Fe,linksBlock:we,loader:qe,list:We,link:Re},Ve=({task:e})=>{var u,k,p,m;const{selectedImage:t,loading:a,handleImageClick:c,handleCloseModal:l}=$e({task:e}),o=((u=e==null?void 0:e.assets)==null?void 0:u.length)>0,h=((k=e==null?void 0:e.links)==null?void 0:k.length)>0;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:_.description,children:[s.jsx(b,{className:_.title,children:"TASK DESCRIPTION"}),s.jsx("p",{children:e.description||"No description added"})]}),s.jsxs("div",{className:_.assetsBlock,children:[s.jsx(b,{className:_.title,children:"Assets"}),s.jsx("div",{className:`${_.assets} ${o?_.assetsCenter:""}`,children:a?s.jsx("div",{className:_.loader,children:s.jsx(M,{})}):o?(p=e==null?void 0:e.assets)==null?void 0:p.map((d,B)=>s.jsx("img",{onClick:()=>c(d),className:_.asset,src:d,alt:`asset ${B}`},`asset-${B}`)):s.jsx("span",{className:_.noAssetsText,children:"No assets available"})})]}),s.jsxs("div",{className:_.linksBlock,children:[s.jsx(b,{className:_.title,children:"Support links"}),s.jsx("div",{className:_.links,children:h?s.jsx("ul",{className:_.list,children:(m=e==null?void 0:e.links)==null?void 0:m.map(d=>s.jsx("li",{className:_.listItem,children:s.jsx("a",{className:_.link,href:d,children:d})},d))}):s.jsx("p",{children:"No links available"})})]}),t&&s.jsx(rs,{changedValue:t,src:t,alt:"Selected asset",onClose:l})]})},Ue="_taskDetail_15ryv_1",Ye="_block_15ryv_12",y={taskDetail:Ue,block:Ye},He=({task:e})=>s.jsxs("section",{className:y.taskDetail,children:[s.jsx("article",{className:y.block,children:s.jsx(Ae,{task:e})}),s.jsx("article",{className:y.block,children:s.jsx(Ve,{task:e})})]});function Ke(e){return X({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13 5h8"},child:[]},{tag:"path",attr:{d:"M13 9h5"},child:[]},{tag:"path",attr:{d:"M13 15h8"},child:[]},{tag:"path",attr:{d:"M13 19h5"},child:[]},{tag:"path",attr:{d:"M3 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"},child:[]},{tag:"path",attr:{d:"M3 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"},child:[]}]})(e)}const Ge="_titleBlock_1sayq_1",Qe="_title_1sayq_1",Xe="_backIcon_1sayq_12",Ze="_tabs_1sayq_28",Je="_content_1sayq_32",f={titleBlock:Ge,title:Qe,backIcon:Xe,tabs:Ze,content:Je},ot=()=>{const{id:e}=I.useParams(),[t,a]=n.useState(1),c=n.useMemo(()=>[{id:1,title:"Task details",icon:s.jsx(Ke,{}),Component:He},{id:2,title:"Activities/Timeline",icon:s.jsx(Z,{}),Component:Rs}],[]),l={data:c,activeTab:t,setActiveTab:a},o=n.useMemo(()=>J.find(m=>m._id===e),[e]),h=n.useMemo(()=>{var m;return(m=c.find(d=>d.id===t))==null?void 0:m.Component},[t,c]),u=I.useNavigate(),[k,p]=n.useState(!0);return n.useEffect(()=>{h&&setTimeout(()=>p(!1),500)},[h]),s.jsxs("section",{className:f.taskDetail,children:[s.jsxs("div",{onClick:()=>u(-1),className:f.titleBlock,children:[s.jsx(ss,{className:f.backIcon}),s.jsx(b,{className:f.title,children:o==null?void 0:o.title})]}),s.jsx("div",{className:f.tabs,children:s.jsx(es,{...l})}),s.jsx("div",{className:f.content,children:k?s.jsx(M,{}):s.jsx(h,{task:o})})]})};export{ot as default};
