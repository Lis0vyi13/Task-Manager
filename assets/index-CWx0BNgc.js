import{j as s,V as w,W as z,X as L,Y as E,Z as O,_ as F,r as n,h as W,L as C,m as R,x as V,J as U,$ as Y,B as G,o as b,a0 as H,G as K,C as S,M as q,k as J,a1 as Q,P as X,a2 as Z,a as I,a3 as ss,t as es,a4 as ts}from"./index-BYnzJnnp.js";import{T as as}from"./index-DvLh2Kdu.js";import{P as cs,S as ns}from"./index-B6HM4YWT.js";import{T as ls,M as os,P as is}from"./transformToInputDateType-aVwzwLye.js";import{Q as rs}from"./index-D2KHYmH9.js";import{S as ds,I as ms}from"./index-BLHy0wcX.js";const _s="_icon_zorh8_1",us="_iconStarted_zorh8_13",xs="_iconCompleted_zorh8_17",hs="_iconInProgress_zorh8_21",ks="_iconBug_zorh8_25",gs="_iconCommented_zorh8_30",k={icon:_s,iconStarted:us,iconCompleted:xs,iconInProgress:hs,iconBug:ks,iconCommented:gs},js={commented:s.jsx("div",{className:`${k.icon} ${k.iconCommented}`,children:s.jsx(w,{})}),started:s.jsx("div",{className:`${k.icon} ${k.iconStarted}`,children:s.jsx(z,{})}),assigned:s.jsx("div",{className:`${k.icon} ${k.iconAssigned}`,children:s.jsx(L,{})}),bug:s.jsx("div",{className:`${k.icon} ${k.iconBug}`,children:s.jsx(E,{size:24})}),completed:s.jsx("div",{className:`${k.icon} ${k.iconCompleted}`,children:s.jsx(O,{size:24})}),"in progress":s.jsx("div",{className:`${k.icon} ${k.iconInProgress}`,children:s.jsx(F,{size:16})})},ps="_activity_wtl5d_1",bs="_iconBlock_wtl5d_6",Ns="_icon_wtl5d_6",vs="_lineBlock_wtl5d_19",Bs="_line_wtl5d_19",fs="_info_wtl5d_29",ys="_username_wtl5d_33",Ts="_typeDateBlock_wtl5d_39",Cs="_type_wtl5d_39",Ms="_date_wtl5d_51",Ss="_activityText_wtl5d_56",j={activity:ps,iconBlock:bs,icon:Ns,lineBlock:vs,line:Bs,info:fs,username:ys,typeDateBlock:Ts,type:Cs,date:Ms,activityText:Ss},Is=n.memo(({activity:e})=>{const t=n.useMemo(()=>{var a;return(a=W.users.find(c=>c._id===e.by))==null?void 0:a.name},[e.by]);return s.jsxs("div",{className:j.activity,children:[s.jsxs("div",{className:j.iconBlock,children:[s.jsx("div",{className:j.icon,children:js[e.type]}),s.jsx("div",{className:j.lineBlock,children:s.jsx("div",{className:j.line})})]}),s.jsxs("div",{className:j.info,children:[s.jsx("h3",{className:j.username,children:t||s.jsx(C,{})}),s.jsxs("div",{className:j.typeDateBlock,children:[s.jsx("span",{className:j.type,children:e.type}),s.jsx("span",{className:j.date,children:R(e.date).fromNow()})]}),s.jsx("h1",{className:j.activityText,children:e.activity})]})]})}),As="_addActivityForm_1x3gf_1",$s="_label_1x3gf_5",Ps="_selectBlock_1x3gf_10",Ds="_select_1x3gf_10",ws="_textareaBlock_1x3gf_39",zs="_textarea_1x3gf_39",Ls="_submitButton_1x3gf_91",Es="_errorText_1x3gf_98",p={addActivityForm:As,label:$s,selectBlock:Ps,select:Ds,textareaBlock:ws,textarea:zs,submitButton:Ls,errorText:Es},Os=()=>{const{register:e,handleSubmit:t,reset:a,formState:{errors:c}}=V(),o=n.useCallback(l=>{console.log(l),a(),U.success("Posted successfull")},[a]);return s.jsxs("form",{onSubmit:t(o),className:p.addActivityForm,children:[s.jsxs("div",{className:p.selectBlock,children:[s.jsx("p",{className:p.label,children:"Type:"}),s.jsx("select",{id:"type",...e("type",{required:!0}),className:p.select,children:Y.map(l=>s.jsx("option",{value:l,children:l},l))}),c.type&&s.jsx("p",{className:p.errorText,children:"Please select a type."})]}),(c==null?void 0:c.type)&&s.jsx("p",{className:p.errorText,children:"Please select a type."}),s.jsxs("div",{className:p.textareaBlock,children:[s.jsx("textarea",{placeholder:"Type...",className:p.textarea,...e("activity",{required:!0}),name:"activity"}),c.activity&&s.jsx("p",{className:p.errorText,children:"Please enter an activity."})]}),s.jsx(G,{className:p.submitButton,type:"submit",children:"Submit"})]})},Fs="_activitiesWrapper_9deir_1",Ws="_title_9deir_14",Rs="_activities_9deir_1",Vs="_left_9deir_25",Us="_right_9deir_29",v={activitiesWrapper:Fs,title:Ws,activities:Rs,left:Vs,right:Us},Ys=({task:e})=>{var t;return s.jsxs("section",{className:v.activitiesWrapper,children:[s.jsxs("article",{className:v.left,children:[s.jsx(b,{className:v.title,children:"Activities"}),s.jsx("div",{className:v.activities,children:((t=e==null?void 0:e.activities)==null?void 0:t.length)>0?e.activities.map(a=>s.jsx(Is,{activity:a},a._id)):"No activities added"})]}),s.jsxs("article",{className:v.right,children:[s.jsx(b,{className:v.title,children:"Add activity"}),s.jsx(Os,{})]})]})};function Gs(e){let t,a,c=0;return e<50?(t=255,a=Math.round(255*(e/50))):(t=Math.round(255*(1-(e-50)/50)),a=255),{background:`rgb(${t}, ${a}, ${c})`,isLight:(t+a+c)/3>128}}const Hs=({task:e})=>{const{subTasks:t}=n.useMemo(()=>e,[e]),a=n.useMemo(()=>t.filter(l=>l.done).length,[t]),c=n.useMemo(()=>a>0?Math.round(a/t.length*100):0,[a,t.length]);return{progressColor:n.useMemo(()=>Gs(c),[c]),subtasksProgress:c,subTasks:t}},Ks="_status_kt5py_1",qs="_uppercase_kt5py_7",Js={status:Ks,uppercase:qs},Qs=({priority:e})=>{const t=n.useMemo(()=>H[e],[e]),a=n.useMemo(()=>e==="normal"?"1px solid #000":"unset",[e]),c=n.useMemo(()=>e==="normal"?"#000":"",[e]);return s.jsx("div",{style:{backgroundColor:t,border:a},className:Js.status,children:s.jsx(cs,{style:{textTransform:"uppercase",fontWeight:"bold",color:c},priority:e,withAddition:!0})})},Xs="_avatar_mgm8r_1",Zs="_info_mgm8r_12",se="_userInfo_mgm8r_18",ee="_name_mgm8r_25",te="_role_mgm8r_29",ae="_member_mgm8r_33",N={avatar:Xs,info:Zs,userInfo:se,name:ee,role:te,member:ae},ce=({user:e})=>s.jsxs("div",{className:N.member,children:[s.jsx(ls,{...e,className:N.avatar,avatarClassName:N.avatar,infoClassName:N.info,team:[e]}),s.jsxs("div",{className:N.userInfo,children:[s.jsx("p",{className:N.name,children:e.name}),s.jsx("span",{className:N.role,children:e.role})]})]}),ne=()=>{const e=n.useCallback(()=>{},[]),{isOpened:t,isClosing:a,handleToggle:c,handleClose:o}=K(),[l,x,u]=S({setItem:()=>{}}),[g,h,m]=S({setItem:()=>{}}),d=n.useMemo(()=>[[{icon:{Icon:q,color:"#000"},title:"Edit",permission:!1,onClick:x}],[{icon:{Icon:J,color:"red"},title:"Delete",permission:!1,onClick:h}]],[h,x]);return{doneHandler:e,isOpened:t,isClosing:a,handleToggle:c,handleClose:o,OPTIONS:d,isDeleteModalOpen:g,closeDeleteModal:m,isEditModalOpen:l,closeEditModal:u}},le="_subtask_1n3l4_1",oe="_subtaskIcon_1n3l4_6",ie="_header_1n3l4_21",re="_date_1n3l4_28",de="_tags_1n3l4_34",me="_tag_1n3l4_34",_e="_doneTag_1n3l4_50",ue="_subtaskInfo_1n3l4_55",xe="_main_1n3l4_60",he="_done_1n3l4_50",ke="_undone_1n3l4_74",ge="_button_1n3l4_79",i={subtask:le,subtaskIcon:oe,header:ie,date:re,tags:de,tag:me,doneTag:_e,subtaskInfo:ue,main:xe,done:he,undone:ke,button:ge},je=({title:e,date:t,tag:a,done:c})=>{const{doneHandler:o,isOpened:l,isClosing:x,handleToggle:u,handleClose:g,OPTIONS:h,isDeleteModalOpen:m,closeDeleteModal:d,isEditModalOpen:f,closeEditModal:A}=ne(),$=n.useMemo(()=>({title:e,date:t,tag:a}),[t,a,e]);return s.jsxs("div",{className:i.subtask,children:[s.jsx("div",{className:i.subtaskIcon,children:s.jsx(Q,{color:"rgb(124,58,237)",size:26})}),s.jsxs("div",{className:i.subtaskInfo,children:[s.jsxs("header",{className:i.header,children:[s.jsx("span",{className:i.date,children:new Date(t).toDateString()}),s.jsxs("div",{className:i.tags,children:[s.jsx("span",{className:i.tag,children:a}),c&&s.jsx("span",{className:`${i.doneTag} ${i.tag}`,children:"Done"})]})]}),s.jsxs("main",{className:i.main,children:[s.jsx("p",{className:i.subtaskTitle,children:e}),s.jsx("div",{className:i.more,children:s.jsx(os,{onClick:u})}),l&&s.jsx(X,{className:`${i.popup}`,isClosing:x,handleClose:g,children:h.map((M,P)=>M.map((y,D)=>s.jsx(is,{disabled:y.permission,className:D+1===M.length&&P+1!==h.length?"divider":"",icon:y.icon,title:y.title,handleClose:g,onClick:y.onClick},y.title)))})]}),s.jsx("footer",{className:i.footer,children:s.jsx("button",{onClick:o,className:`${c?i.undone:i.done} ${i.button}`,children:c?"Mark as Undone":"Mark as Done"})}),f&&s.jsx(ds,{changedValue:f,onClose:A,subtask:$}),m&&s.jsx(rs,{changedValue:m,onClose:d,type:"delete",text:"Are you sure to delete current subtask?"})]})]})},pe="_taskInfo_1yzlk_1",be="_priorityStageBlock_1yzlk_6",Ne="_stageBlock_1yzlk_13",ve="_stage_1yzlk_13",Be="_createdAtBlock_1yzlk_24",fe="_createdAt_1yzlk_24",ye="_assetsSubTasksBlock_1yzlk_34",Te="_teamBlock_1yzlk_46",Ce="_subtasksBlock_1yzlk_47",Me="_titleSecondary_1yzlk_51",Se="_memberBlock_1yzlk_57",Ie="_substasksTitle_1yzlk_62",Ae="_subtasksProgress_1yzlk_68",$e="_subtasks_1yzlk_47",r={taskInfo:pe,priorityStageBlock:be,stageBlock:Ne,stage:ve,createdAtBlock:Be,createdAt:fe,assetsSubTasksBlock:ye,teamBlock:Te,subtasksBlock:Ce,titleSecondary:Me,memberBlock:Se,substasksTitle:Ie,subtasksProgress:Ae,subtasks:$e},Pe=n.memo(({task:e})=>{const{progressColor:t,subtasksProgress:a,subTasks:c}=Hs({task:e});return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:r.taskInfo,children:[s.jsxs("div",{className:r.priorityStageBlock,children:[s.jsx(Qs,{priority:e.priority}),s.jsxs("div",{className:r.stageBlock,children:[s.jsx(ns,{stage:e.stage}),s.jsx("span",{className:r.stage,children:e.stage})]})]}),s.jsx("div",{className:r.createdAtBlock,children:s.jsxs("span",{className:r.createdAt,children:["Created at: ",new Date(e.createdAt).toDateString()]})})]}),s.jsxs("div",{className:r.assetsSubTasksBlock,children:[s.jsxs("span",{children:["Assets: ",e.assets.length]}),s.jsx("span",{children:"|"}),s.jsxs("span",{children:["Sub-Tasks: ",e.subTasks.length]})]}),s.jsxs("div",{className:r.teamBlock,children:[s.jsx(b,{className:r.titleSecondary,children:"TASK TEAM"}),s.jsx("div",{className:r.team,children:e.team.map(o=>s.jsx("div",{className:r.memberBlock,children:s.jsx(ce,{user:o})},o._id))})]}),s.jsxs("div",{className:r.subtasksBlock,children:[s.jsxs("div",{className:r.substasksTitle,children:[s.jsx(b,{className:r.titleSecondary,children:"Sub-tasks"}),s.jsx("div",{style:{background:t.background},className:r.subtasksProgress,children:s.jsxs("span",{style:{color:t.isLight?"#000":"#fff"},className:r.subtasksProgressValue,children:[a.toFixed(2),"%"]})})]}),s.jsx("div",{className:r.subtasks,children:c.map(o=>s.jsx(je,{...o},o._id))})]})]})}),De=({task:e})=>{const[t,a]=n.useState(null),[c,o]=n.useState(!0);n.useEffect(()=>{var u;if(e.assets&&e.assets.length>0){const g=(u=e==null?void 0:e.assets)==null?void 0:u.map(h=>new Promise(m=>{const d=new Image;d.src=h,d.onload=m,d.onerror=m}));Promise.all(g).then(()=>{o(!1)})}else o(!1)},[e.assets]);const l=n.useCallback(u=>{a(u)},[]),x=n.useCallback(()=>{a(null)},[]);return{selectedImage:t,loading:c,handleImageClick:l,handleCloseModal:x}},we="_title_brxcw_1",ze="_assetsBlock_brxcw_6",Le="_assets_brxcw_6",Ee="_assetsCenter_brxcw_18",Oe="_noAssetsText_brxcw_27",Fe="_asset_brxcw_6",We="_supportLinksBlock_brxcw_42",Re="_linksBlock_brxcw_43",Ve="_loader_brxcw_47",Ue="_list_brxcw_51",Ye="_link_brxcw_43",_={title:we,assetsBlock:ze,assets:Le,assetsCenter:Ee,noAssetsText:Oe,asset:Fe,supportLinksBlock:We,linksBlock:Re,loader:Ve,list:Ue,link:Ye},Ge=({task:e})=>{var u,g,h,m;const{selectedImage:t,loading:a,handleImageClick:c,handleCloseModal:o}=De({task:e}),l=((u=e==null?void 0:e.assets)==null?void 0:u.length)>0,x=((g=e==null?void 0:e.links)==null?void 0:g.length)>0;return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:_.description,children:[s.jsx(b,{className:_.title,children:"TASK DESCRIPTION"}),s.jsx("p",{children:e.description||"No description added"})]}),s.jsxs("div",{className:_.assetsBlock,children:[s.jsx(b,{className:_.title,children:"Assets"}),s.jsx("div",{className:`${_.assets} ${l?_.assetsCenter:""}`,children:a?s.jsx("div",{className:_.loader,children:s.jsx(C,{})}):l?(h=e==null?void 0:e.assets)==null?void 0:h.map((d,f)=>s.jsx("img",{onClick:()=>c(d),className:_.asset,src:d,alt:`asset ${f}`},`asset-${f}`)):s.jsx("span",{className:_.noAssetsText,children:"No assets available"})})]}),s.jsxs("div",{className:_.linksBlock,children:[s.jsx(b,{className:_.title,children:"Support links"}),s.jsx("div",{className:_.links,children:x?s.jsx("ul",{className:_.list,children:(m=e==null?void 0:e.links)==null?void 0:m.map(d=>s.jsx("li",{className:_.listItem,children:s.jsx("a",{className:_.link,href:d,children:d})},d))}):s.jsx("p",{children:"No links available"})})]}),t&&s.jsx(ms,{changedValue:t,src:t,alt:"Selected asset",onClose:o})]})},He="_taskDetail_1g647_1",Ke="_block_1g647_13",T={taskDetail:He,block:Ke},qe=({task:e})=>s.jsxs("section",{className:T.taskDetail,children:[s.jsx("article",{className:T.block,children:s.jsx(Pe,{task:e})}),s.jsx("article",{className:T.block,children:s.jsx(Ge,{task:e})})]});function Je(e){return Z({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M13 5h8"},child:[]},{tag:"path",attr:{d:"M13 9h5"},child:[]},{tag:"path",attr:{d:"M13 15h8"},child:[]},{tag:"path",attr:{d:"M13 19h5"},child:[]},{tag:"path",attr:{d:"M3 4m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"},child:[]},{tag:"path",attr:{d:"M3 14m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v4a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z"},child:[]}]})(e)}const Qe="_titleBlock_tlnmo_1",Xe="_title_tlnmo_1",Ze="_backIcon_tlnmo_12",st="_tabs_tlnmo_28",et="_content_tlnmo_32",B={titleBlock:Qe,title:Xe,backIcon:Ze,tabs:st,content:et},it=()=>{const{id:e}=I.useParams(),[t,a]=n.useState(1),c=n.useMemo(()=>[{id:1,title:"Task details",icon:s.jsx(Je,{}),Component:qe},{id:2,title:"Activities/Timeline",icon:s.jsx(ss,{}),Component:Ys}],[]),o={data:c,activeTab:t,setActiveTab:a},l=n.useMemo(()=>es.find(m=>m._id===e),[e]),x=n.useMemo(()=>{var m;return(m=c.find(d=>d.id===t))==null?void 0:m.Component},[t,c]),u=I.useNavigate(),[g,h]=n.useState(!0);return n.useEffect(()=>{x&&setTimeout(()=>h(!1),500)},[x]),s.jsxs("section",{className:B.taskDetail,children:[s.jsxs("div",{onClick:()=>u(-1),className:B.titleBlock,children:[s.jsx(ts,{className:B.backIcon}),s.jsx(b,{className:B.title,children:l==null?void 0:l.title})]}),s.jsx("div",{className:B.tabs,children:s.jsx(as,{...o})}),s.jsx("div",{className:B.content,children:g?s.jsx(C,{}):s.jsx(x,{task:l})})]})};export{it as default};
