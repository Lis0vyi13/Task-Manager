import{r as k,v as q,j as s,w as v,P as E,a as b,x as L,y as w,F as I,e as D,f as z,L as R}from"./index-d2EGw5oL.js";import{u as P}from"./index-sjEg0t_o.js";import{T as B}from"./index-VSNq4Tb6.js";import{M as Q,P as V,T as F}from"./transformToInputDateType-DWvk148s.js";import{P as H,S as W}from"./index-BYW5mdP-.js";import{u as K,m as U}from"./useTaskDetailHandler-BR0vCfsk.js";import{u as G}from"./useSearch-BJP6Z1JU.js";import{Q as J}from"./index-B37HlN2s.js";const X=({tasks:e,stage:i})=>{const[o,d]=k.useState(!0),a=G(),l=k.useMemo(()=>{d(!0);const m=e.filter(c=>!c.isTrashed),_=i?m.filter(c=>c.stage===i):m,p=a?_.filter(c=>c.title.toLowerCase().includes(a.toLowerCase())):_;return d(!1),p},[a,i,e]);return{isLoading:o,filteredTasks:l}},Y=({task:e})=>{const i=q(),o=k.useCallback(()=>{},[]),d=k.useCallback(()=>{},[]),{handleToggle:a,isOpened:l,isClosing:m,handleClose:_,TASK_MORE_OPTIONS:p,navigate:c,openAddSubtaskModal:N,isEditModalOpen:T,closeEditModal:h,isAddSubtaskModalOpen:g,closeAddSubtaskModal:y,isQuestionModalOpen:M,closeQuestionModal:A,isStageModalOpen:$,openStageModal:S,closeStageModal:u}=P({task:e});return{user:i,handleToggle:a,isOpened:l,isClosing:m,handleClose:_,TASK_MORE_OPTIONS:p,navigate:c,openAddSubtaskModal:N,isEditModalOpen:T,closeEditModal:h,isAddSubtaskModalOpen:g,closeAddSubtaskModal:y,isQuestionModalOpen:M,closeQuestionModal:A,isStageModalOpen:$,openStageModal:S,closeStageModal:u,onAddSubtaskHandler:o,onDeleteTaskHandler:d}},Z="_subtask_pyneq_1",ss="_dateTagContainer_pyneq_8",es="_date_pyneq_8",ts="_tag_pyneq_21",f={subtask:Z,dateTagContainer:ss,date:es,tag:ts},as=({title:e,date:i,tag:o,index:d})=>s.jsxs("article",{className:f.subtask,children:[s.jsxs("p",{className:f.title,children:[d+1+") ",e]}),s.jsxs("div",{className:f.dateTagContainer,children:[s.jsx("span",{className:f.date,children:v(new Date(i))}),s.jsx("span",{className:f.tag,children:o})]})]}),ns="_task_1uxde_1",ds="_content_1uxde_7",is="_header_1uxde_11",os="_main_1uxde_18",ls="_headerInfo_1uxde_22",cs="_taskTitle_1uxde_29",rs="_title_1uxde_40",_s="_headerTop_1uxde_45",us="_date_1uxde_53",ms="_details_1uxde_68",ps="_commentary_1uxde_77",hs="_assets_1uxde_78",xs="_subtasks_1uxde_79",js="_team_1uxde_108",bs="_userInfo_1uxde_112",ks="_footer_1uxde_125",Ns="_subtasksWrapper_1uxde_144",Ts="_btnAddSubtask_1uxde_153",gs="_disabled_1uxde_167",ys="_popup_1uxde_179",Ms="_divider_1uxde_184",n={task:ns,content:ds,header:is,main:os,headerInfo:ls,taskTitle:cs,title:rs,headerTop:_s,date:us,details:ms,commentary:ps,assets:hs,subtasks:xs,team:js,userInfo:bs,footer:ks,subtasksWrapper:Ns,btnAddSubtask:Ts,disabled:gs,popup:ys,divider:Ms},oe=({task:e})=>{const{handleToggle:i,isOpened:o,isClosing:d,handleClose:a,TASK_MORE_OPTIONS:l,navigate:m,user:_,openAddSubtaskModal:p,isEditModalOpen:c,closeEditModal:N,isAddSubtaskModalOpen:T,closeAddSubtaskModal:h,onAddSubtaskHandler:g,isQuestionModalOpen:y,closeQuestionModal:M,onDeleteTaskHandler:A,isStageModalOpen:$,closeStageModal:S}=Y({task:e});return s.jsx("div",{className:n.task,children:s.jsxs("div",{className:n.content,children:[s.jsx("header",{className:n.header,children:s.jsxs("div",{className:n.headerInfo,children:[s.jsxs("div",{className:n.headerTop,children:[s.jsx(H,{withAddition:!0,priority:e.priority}),s.jsx(Q,{onClick:i}),o&&s.jsx(E,{className:`${n.popup}`,isClosing:d,handleClose:a,children:l.map((u,x)=>u.map((r,C)=>s.jsx(V,{disabled:r.permission,className:C+1===u.length&&x+1!==l.length?"divider":"",icon:r.icon,title:r.title,handleClose:a,onClick:r.onClick},r.title)))}),s.jsx(B,{task:e,isEditModalOpen:c,closeEditModal:N,isAddSubtaskModalOpen:T,closeAddSubtaskModal:h,onAddSubtaskHandler:g,isQuestionModalOpen:y,closeQuestionModal:M,onDeleteTaskHandler:A,isStageModalOpen:$,closeStageModal:S})]}),s.jsxs("div",{onClick:()=>m(e._id),className:n.taskTitle,children:[s.jsx(W,{stage:e.stage}),s.jsx("h1",{className:n.title,children:e.title})]}),s.jsx("div",{className:n.date,children:v(new Date(e.date))})]})}),s.jsxs("main",{className:n.main,children:[s.jsxs("section",{className:n.details,children:[s.jsxs(b.Link,{to:`/task/${e._id}`,title:"Commentary",className:n.commentary,children:[s.jsx(L,{}),s.jsx("span",{children:e.activities.length})]}),s.jsxs(b.Link,{to:`/task/${e._id}`,title:"Assets",className:n.assets,children:[s.jsx(w,{}),s.jsx("span",{children:e.assets.length})]}),s.jsxs(b.Link,{to:`/task/${e._id}`,title:"Subtasks",className:n.subtasks,children:[s.jsx(I,{}),s.jsxs("span",{children:["0/",e.subTasks.length]})]})]}),s.jsx("section",{children:s.jsx(F,{infoClassName:n.userInfo,className:n.team,team:e.team})})]}),s.jsxs("footer",{className:n.footer,children:[s.jsx("section",{className:n.subtasksWrapper,children:e.subTasks.map((u,x)=>k.createElement(as,{index:x,...u,key:u._id}))}),s.jsxs("button",{disabled:_.isAdmin,onClick:_.isAdmin&&p,className:`${n.btnAddSubtask} ${_.isAdmin?"":n.disabled}`,children:[s.jsx("span",{children:"+"})," ",s.jsx("p",{children:"Add subtask"})]})]})]})})},As="_table_13971_1",$s="_thead_13971_6",Ss="_tbody_13971_15",fs="_tr_13971_20",Cs="_th_13971_6",j={table:As,thead:$s,tbody:Ss,tr:fs,th:Cs},Os="_tr_1skud_1",vs="_td_1skud_26",Es="_capitalize_1skud_35",Ls="_tableTitle_1skud_56",ws="_circle_1skud_67",Is="_title_1skud_73",Ds="_priority_1skud_78",Ps="_createdAt_1skud_90",Bs="_daysAgo_1skud_95",Qs="_details_1skud_99",Vs="_commentary_1skud_108",Fs="_assets_1skud_109",Hs="_subtasks_1skud_110",Ws="_subtasksWrapper_1skud_127",qs="_team_1skud_148",zs="_actions_1skud_152",Rs="_editBtn_1skud_158",Ks="_deleteBtn_1skud_169",t={tr:Os,td:vs,capitalize:Es,tableTitle:Ls,circle:ws,title:Is,priority:Ds,createdAt:Ps,daysAgo:Bs,details:Qs,commentary:Vs,assets:Fs,subtasks:Hs,subtasksWrapper:Ws,team:qs,actions:zs,editBtn:Rs,deleteBtn:Ks},Us=({task:e,navigateToTask:i})=>{const{isEditModalOpen:o,closeEditModal:d,isQuestionModalOpen:a,closeQuestionModal:l,openQuestionModal:m,openEditModal:_,handleToggle:p,isOpened:c,isClosing:N,closeAddSubtaskModal:T,handleClose:h,isAddSubtaskModalOpen:g,onAddSubtaskHandler:y,closeStageModal:M,isStageModalOpen:A,onDeleteTaskHandler:$,TASK_MORE_OPTIONS:S}=P({task:e}),{isDesktop:u}=D();return s.jsxs("tr",{className:t.tr,children:[s.jsxs("td",{onClick:()=>i(e._id),className:`${t.tableTitle} ${t.td}`,children:[s.jsx(W,{stage:e.stage}),s.jsx("h1",{className:t.title,children:e.title})]}),u?s.jsxs(s.Fragment,{children:[s.jsx("td",{className:`${t.priority} ${t.td}`,children:s.jsx(H,{withAddition:!0,priority:e.priority})}),s.jsx("td",{className:`${t.td} ${t.createdAt} ${t.capitalize}`,children:s.jsx("span",{className:t.daysAgo,children:v(new Date(e.date))})}),s.jsxs("td",{className:`${t.td} ${t.details}`,children:[s.jsxs(b.Link,{to:`/task/${e._id}`,title:"Commentary",className:t.commentary,children:[s.jsx(L,{}),s.jsx("span",{children:e.activities.length})]}),s.jsxs(b.Link,{to:`/task/${e._id}`,title:"Assets",className:t.assets,children:[s.jsx(w,{}),s.jsx("span",{children:e.assets.length})]}),s.jsxs(b.Link,{to:`/task/${e._id}`,title:"Subtasks",className:t.subtasks,children:[s.jsx(I,{}),s.jsxs("span",{children:["0/",e.subTasks.length]})]})]}),s.jsx("td",{className:`${t.td}`,children:s.jsx(F,{infoClassName:t.userInfo,side:"left",className:t.team,team:e.team})}),s.jsxs("td",{className:`${t.actions} ${t.td} `,children:[s.jsx("button",{onClick:()=>_(e),className:t.editBtn,children:"Edit"}),s.jsx("button",{onClick:()=>m(e),className:t.deleteBtn,children:"Delete"})]})]}):s.jsxs("td",{className:t.more,children:[s.jsx(Q,{onClick:()=>{p()}}),c&&s.jsx(E,{className:`${t.popup}`,isClosing:N,handleClose:h,children:S.map(x=>x.map((r,C)=>s.jsx(V,{disabled:r.permission,className:C+1===x.length?"divider":"",icon:r.icon,title:r.title,handleClose:h,onClick:r.onClick},r.title)))})]}),s.jsx(B,{task:e,isEditModalOpen:o,closeEditModal:d,isAddSubtaskModalOpen:g,closeAddSubtaskModal:T,onAddSubtaskHandler:y,isQuestionModalOpen:a,closeQuestionModal:l,onDeleteTaskHandler:$,isStageModalOpen:A,closeStageModal:M}),a&&s.jsx(J,{changedValue:a,onClose:l,task:e,type:"delete",text:"Are you sure you want to delete the selected task?",submitButtonText:"Delete"})]},e._id)},Gs=({filteredTasks:e,titles:i,navigateToTask:o})=>{const{isDesktop:d}=D();return s.jsxs("table",{className:j.table,children:[s.jsx("thead",{className:j.thead,children:s.jsx("tr",{className:j.tr,children:d?i.map(a=>s.jsx("th",{className:`${j.th}`,children:a},a)):s.jsx("th",{className:j.th,children:i[0]})})}),s.jsx("tbody",{className:j.tbody,children:e.map(a=>s.jsx(Us,{task:a,navigateToTask:o},a==null?void 0:a._id))})]})},Js="_listView_ji7mn_1",Xs="_notEmpty_ji7mn_12",O={listView:Js,notEmpty:Xs},Ys=["Task title","Priority","Created At","Assets","Team"],le=({tasks:e,stage:i})=>{const{isLoading:o,filteredTasks:d}=X({tasks:e,stage:i}),a=K(),l=k.useMemo(()=>({filteredTasks:d,titles:Ys,navigateToTask:a}),[d,a]);return s.jsx(U.section,{initial:"hidden",animate:"visible",variants:z,className:`${O.listView} ${d.length>0?O.notEmpty:""}`,children:o?s.jsx(R,{}):d.length>0?s.jsx(Gs,{...l}):s.jsx("span",{className:O.notFound,children:"Tasks not found"})})};export{le as L,oe as T,X as u};
