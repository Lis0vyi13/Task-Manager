import{r as b,u as z,j as s,p as O,P as v,a as k,q as E,v as w,F as L,f as R,L as q}from"./index-BX26S4WO.js";import{u as I}from"./index-DCTuSknW.js";import{T as D}from"./index-CraaxDu5.js";import{M as P,P as B,T as Q}from"./transformToInputDateType-lL7WdnI8.js";import{P as V,S as F}from"./index-uQ3NiPyg.js";import{u as H,a as K,m as U}from"./useTaskDetailHandler-C-VvlUC1.js";import{u as G}from"./useSearch-Ctm0nVG3.js";import{Q as J}from"./index-CVn_QiJ2.js";const X=({tasks:e,stage:o})=>{const[l,i]=b.useState(!0),a=G(),c=b.useMemo(()=>{i(!0);const p=e.filter(d=>!d.isTrashed),r=o?p.filter(d=>d.stage===o):p,u=a?r.filter(d=>d.title.toLowerCase().includes(a.toLowerCase())):r;return i(!1),u},[a,o,e]);return{isLoading:l,filteredTasks:c}},Y=({task:e})=>{const o=z(),l=b.useCallback(()=>{},[]),i=b.useCallback(()=>{},[]),{handleToggle:a,isOpened:c,isClosing:p,handleClose:r,TASK_MORE_OPTIONS:u,navigate:d,openAddSubtaskModal:f,isEditModalOpen:N,closeEditModal:x,isAddSubtaskModalOpen:T,closeAddSubtaskModal:g,isQuestionModalOpen:y,closeQuestionModal:M,isStageModalOpen:A,openStageModal:$,closeStageModal:m}=I({task:e});return{user:o,handleToggle:a,isOpened:c,isClosing:p,handleClose:r,TASK_MORE_OPTIONS:u,navigate:d,openAddSubtaskModal:f,isEditModalOpen:N,closeEditModal:x,isAddSubtaskModalOpen:T,closeAddSubtaskModal:g,isQuestionModalOpen:y,closeQuestionModal:M,isStageModalOpen:A,openStageModal:$,closeStageModal:m,onAddSubtaskHandler:l,onDeleteTaskHandler:i}},Z="_subtask_1owpa_1",ss="_dateTagContainer_1owpa_8",es="_date_1owpa_8",ts="_tag_1owpa_21",S={subtask:Z,dateTagContainer:ss,date:es,tag:ts},as=({title:e,date:o,tag:l,index:i})=>s.jsxs("article",{className:S.subtask,children:[s.jsxs("p",{className:S.title,children:[i+1+") ",e]}),s.jsxs("div",{className:S.dateTagContainer,children:[s.jsx("span",{className:S.date,children:O(new Date(o))}),s.jsx("span",{className:S.tag,children:l})]})]}),ns="_task_1c6fk_1",is="_content_1c6fk_7",os="_header_1c6fk_11",ls="_main_1c6fk_18",ds="_headerInfo_1c6fk_22",cs="_taskTitle_1c6fk_29",rs="_title_1c6fk_40",_s="_headerTop_1c6fk_45",ms="_date_1c6fk_53",ps="_details_1c6fk_68",us="_commentary_1c6fk_77",hs="_assets_1c6fk_78",xs="_subtasks_1c6fk_79",js="_team_1c6fk_108",ks="_userInfo_1c6fk_112",bs="_footer_1c6fk_125",fs="_subtasksWrapper_1c6fk_138",Ns="_btnAddSubtask_1c6fk_147",Ts="_disabled_1c6fk_161",gs="_popup_1c6fk_172",ys="_divider_1c6fk_176",n={task:ns,content:is,header:os,main:ls,headerInfo:ds,taskTitle:cs,title:rs,headerTop:_s,date:ms,details:ps,commentary:us,assets:hs,subtasks:xs,team:js,userInfo:ks,footer:bs,subtasksWrapper:fs,btnAddSubtask:Ns,disabled:Ts,popup:gs,divider:ys},le=({task:e})=>{const{handleToggle:o,isOpened:l,isClosing:i,handleClose:a,TASK_MORE_OPTIONS:c,navigate:p,user:r,openAddSubtaskModal:u,isEditModalOpen:d,closeEditModal:f,isAddSubtaskModalOpen:N,closeAddSubtaskModal:x,onAddSubtaskHandler:T,isQuestionModalOpen:g,closeQuestionModal:y,onDeleteTaskHandler:M,isStageModalOpen:A,closeStageModal:$}=Y({task:e});return s.jsx("div",{className:n.task,children:s.jsxs("div",{className:n.content,children:[s.jsx("header",{className:n.header,children:s.jsxs("div",{className:n.headerInfo,children:[s.jsxs("div",{className:n.headerTop,children:[s.jsx(V,{withAddition:!0,priority:e.priority}),s.jsx(P,{onClick:o}),l&&s.jsx(v,{className:`${n.popup}`,isClosing:i,handleClose:a,children:c.map(m=>m.map((_,h)=>s.jsx(B,{disabled:_.permission,className:h+1===m.length?"divider":"",icon:_.icon,title:_.title,handleClose:a,onClick:_.onClick},_.title)))}),s.jsx(D,{task:e,isEditModalOpen:d,closeEditModal:f,isAddSubtaskModalOpen:N,closeAddSubtaskModal:x,onAddSubtaskHandler:T,isQuestionModalOpen:g,closeQuestionModal:y,onDeleteTaskHandler:M,isStageModalOpen:A,closeStageModal:$})]}),s.jsxs("div",{onClick:()=>p(e._id),className:n.taskTitle,children:[s.jsx(F,{stage:e.stage}),s.jsx("h1",{className:n.title,children:e.title})]}),s.jsx("div",{className:n.date,children:O(new Date(e.date))})]})}),s.jsxs("main",{className:n.main,children:[s.jsxs("section",{className:n.details,children:[s.jsxs(k.Link,{to:`/task/${e._id}`,title:"Commentary",className:n.commentary,children:[s.jsx(E,{}),s.jsx("span",{children:e.activities.length})]}),s.jsxs(k.Link,{to:`/task/${e._id}`,title:"Assets",className:n.assets,children:[s.jsx(w,{}),s.jsx("span",{children:e.assets.length})]}),s.jsxs(k.Link,{to:`/task/${e._id}`,title:"Subtasks",className:n.subtasks,children:[s.jsx(L,{}),s.jsxs("span",{children:["0/",e.subTasks.length]})]})]}),s.jsx("section",{children:s.jsx(Q,{infoClassName:n.userInfo,className:n.team,team:e.team})})]}),s.jsxs("footer",{className:n.footer,children:[s.jsx("section",{className:n.subtasksWrapper,children:e.subTasks.map((m,_)=>b.createElement(as,{index:_,...m,key:m._id}))}),s.jsxs("button",{disabled:r.isAdmin,onClick:r.isAdmin&&u,className:`${n.btnAddSubtask} ${r.isAdmin?"":n.disabled}`,children:[s.jsx("span",{children:"+"})," ",s.jsx("p",{children:"Add subtask"})]})]})]})})},Ms="_table_1jfay_1",As="_thead_1jfay_7",$s="_tbody_1jfay_16",Ss="_tr_1jfay_21",Cs="_th_1jfay_7",j={table:Ms,thead:As,tbody:$s,tr:Ss,th:Cs},Os="_tr_102ss_1",vs="_td_102ss_25",Es="_capitalize_102ss_34",ws="_tableTitle_102ss_55",Ls="_circle_102ss_66",Is="_title_102ss_72",Ds="_priority_102ss_77",Ps="_createdAt_102ss_89",Bs="_daysAgo_102ss_94",Qs="_details_102ss_98",Vs="_commentary_102ss_107",Fs="_assets_102ss_108",Hs="_subtasks_102ss_109",Ws="_subtasksWrapper_102ss_126",zs="_team_102ss_147",Rs="_actions_102ss_151",qs="_editBtn_102ss_157",Ks="_deleteBtn_102ss_168",t={tr:Os,td:vs,capitalize:Es,tableTitle:ws,circle:Ls,title:Is,priority:Ds,createdAt:Ps,daysAgo:Bs,details:Qs,commentary:Vs,assets:Fs,subtasks:Hs,subtasksWrapper:Ws,team:zs,actions:Rs,editBtn:qs,deleteBtn:Ks},Us=({task:e,navigateToTask:o})=>{const{isEditModalOpen:l,closeEditModal:i,isQuestionModalOpen:a,closeQuestionModal:c,openQuestionModal:p,openEditModal:r,handleToggle:u,isOpened:d,isClosing:f,closeAddSubtaskModal:N,handleClose:x,isAddSubtaskModalOpen:T,onAddSubtaskHandler:g,closeStageModal:y,isStageModalOpen:M,onDeleteTaskHandler:A,TASK_MORE_OPTIONS:$}=I({task:e}),{isDesktop:m}=H();return s.jsxs("tr",{className:t.tr,children:[s.jsxs("td",{onClick:()=>o(e._id),className:`${t.tableTitle} ${t.td}`,children:[s.jsx(F,{stage:e.stage}),s.jsx("h1",{className:t.title,children:e.title})]}),m?s.jsxs(s.Fragment,{children:[s.jsx("td",{className:`${t.priority} ${t.td}`,children:s.jsx(V,{withAddition:!0,priority:e.priority})}),s.jsx("td",{className:`${t.td} ${t.createdAt} ${t.capitalize}`,children:s.jsx("span",{className:t.daysAgo,children:O(new Date(e.date))})}),s.jsxs("td",{className:`${t.td} ${t.details}`,children:[s.jsxs(k.Link,{to:`/task/${e._id}`,title:"Commentary",className:t.commentary,children:[s.jsx(E,{}),s.jsx("span",{children:e.activities.length})]}),s.jsxs(k.Link,{to:`/task/${e._id}`,title:"Assets",className:t.assets,children:[s.jsx(w,{}),s.jsx("span",{children:e.assets.length})]}),s.jsxs(k.Link,{to:`/task/${e._id}`,title:"Subtasks",className:t.subtasks,children:[s.jsx(L,{}),s.jsxs("span",{children:["0/",e.subTasks.length]})]})]}),s.jsx("td",{className:`${t.td}`,children:s.jsx(Q,{infoClassName:t.userInfo,side:"left",className:t.team,team:e.team})}),s.jsxs("td",{className:`${t.actions} ${t.td} `,children:[s.jsx("button",{onClick:()=>r(e),className:t.editBtn,children:"Edit"}),s.jsx("button",{onClick:()=>p(e),className:t.deleteBtn,children:"Delete"})]})]}):s.jsxs("td",{className:t.more,children:[s.jsx(P,{onClick:()=>{u()}}),d&&s.jsx(v,{className:`${t.popup}`,isClosing:f,handleClose:x,children:$.map(_=>_.map((h,W)=>s.jsx(B,{disabled:h.permission,className:W+1===_.length?"divider":"",icon:h.icon,title:h.title,handleClose:x,onClick:h.onClick},h.title)))})]}),s.jsx(D,{task:e,isEditModalOpen:l,closeEditModal:i,isAddSubtaskModalOpen:T,closeAddSubtaskModal:N,onAddSubtaskHandler:g,isQuestionModalOpen:a,closeQuestionModal:c,onDeleteTaskHandler:A,isStageModalOpen:M,closeStageModal:y}),a&&s.jsx(J,{changedValue:a,onClose:c,task:e,type:"delete",text:"Are you sure you want to delete the selected task?",submitButtonText:"Delete"})]},e._id)},Gs=({filteredTasks:e,titles:o,navigateToTask:l})=>{const{isDesktop:i}=H();return s.jsxs("table",{className:j.table,children:[s.jsx("thead",{className:j.thead,children:s.jsx("tr",{className:j.tr,children:i?o.map(a=>s.jsx("th",{className:`${j.th}`,children:a},a)):s.jsx("th",{className:j.th,children:o[0]})})}),s.jsx("tbody",{className:j.tbody,children:e.map(a=>s.jsx(Us,{task:a,navigateToTask:l},a==null?void 0:a._id))})]})},Js="_listView_ec274_1",Xs="_notEmpty_ec274_12",C={listView:Js,notEmpty:Xs},Ys=["Task title","Priority","Created At","Assets","Team"],de=({tasks:e,stage:o})=>{const{isLoading:l,filteredTasks:i}=X({tasks:e,stage:o}),a=K(),c=b.useMemo(()=>({filteredTasks:i,titles:Ys,navigateToTask:a}),[i,a]);return s.jsx(U.section,{initial:"hidden",animate:"visible",variants:R,className:`${C.listView} ${i.length>0?C.notEmpty:""}`,children:l?s.jsx(q,{}):i.length>0?s.jsx(Gs,{...c}):s.jsx("span",{className:C.notFound,children:"Tasks not found"})})};export{de as L,le as T,X as u};
