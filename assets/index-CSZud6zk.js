import{r as b,u as W,j as s,p as $,P as O,q as v,v as w,F as E,f as z,L as R}from"./index-C4BvmKIC.js";import{u as I,M as D,P}from"./transformToInputDateType-Bu6lzGtH.js";import{T as B}from"./index-DFvQ0ZEc.js";import{T as L}from"./index-CbgXpp_J.js";import{P as Q,S as V}from"./index-C0IukqqV.js";import{u as F,Q as q,a as K,m as U}from"./index-BM1N_-Y_.js";import{u as G}from"./useSearch-CGeVfClh.js";const J=({tasks:e,stage:l})=>{const[o,i]=b.useState(!0),a=G(),c=b.useMemo(()=>{i(!0);const p=e.filter(d=>!d.isTrashed),r=l?p.filter(d=>d.stage===l):p,u=a?r.filter(d=>d.title.toLowerCase().includes(a.toLowerCase())):r;return i(!1),u},[a,l,e]);return{isLoading:o,filteredTasks:c}},X=({task:e})=>{const l=W(),o=b.useCallback(()=>{},[]),i=b.useCallback(()=>{},[]),{handleToggle:a,isOpened:c,isClosing:p,handleClose:r,TASK_MORE_OPTIONS:u,navigate:d,openAddSubtaskModal:k,isEditModalOpen:f,closeEditModal:j,isAddSubtaskModalOpen:N,closeAddSubtaskModal:T,isQuestionModalOpen:g,closeQuestionModal:y,isStageModalOpen:M,openStageModal:A,closeStageModal:m}=I({task:e});return{user:l,handleToggle:a,isOpened:c,isClosing:p,handleClose:r,TASK_MORE_OPTIONS:u,navigate:d,openAddSubtaskModal:k,isEditModalOpen:f,closeEditModal:j,isAddSubtaskModalOpen:N,closeAddSubtaskModal:T,isQuestionModalOpen:g,closeQuestionModal:y,isStageModalOpen:M,openStageModal:A,closeStageModal:m,onAddSubtaskHandler:o,onDeleteTaskHandler:i}},Y="_subtask_1owpa_1",Z="_dateTagContainer_1owpa_8",ss="_date_1owpa_8",es="_tag_1owpa_21",S={subtask:Y,dateTagContainer:Z,date:ss,tag:es},ts=({title:e,date:l,tag:o,index:i})=>s.jsxs("article",{className:S.subtask,children:[s.jsxs("p",{className:S.title,children:[i+1+") ",e]}),s.jsxs("div",{className:S.dateTagContainer,children:[s.jsx("span",{className:S.date,children:$(new Date(l))}),s.jsx("span",{className:S.tag,children:o})]})]}),as="_task_1c6fk_1",ns="_content_1c6fk_7",is="_header_1c6fk_11",ls="_main_1c6fk_18",os="_headerInfo_1c6fk_22",ds="_taskTitle_1c6fk_29",cs="_title_1c6fk_40",rs="_headerTop_1c6fk_45",_s="_date_1c6fk_53",ms="_details_1c6fk_68",ps="_commentary_1c6fk_77",us="_assets_1c6fk_78",hs="_subtasks_1c6fk_79",js="_team_1c6fk_108",xs="_userInfo_1c6fk_112",bs="_footer_1c6fk_125",ks="_subtasksWrapper_1c6fk_138",fs="_btnAddSubtask_1c6fk_147",Ns="_disabled_1c6fk_161",Ts="_popup_1c6fk_172",gs="_divider_1c6fk_176",n={task:as,content:ns,header:is,main:ls,headerInfo:os,taskTitle:ds,title:cs,headerTop:rs,date:_s,details:ms,commentary:ps,assets:us,subtasks:hs,team:js,userInfo:xs,footer:bs,subtasksWrapper:ks,btnAddSubtask:fs,disabled:Ns,popup:Ts,divider:gs},ie=({task:e})=>{const{handleToggle:l,isOpened:o,isClosing:i,handleClose:a,TASK_MORE_OPTIONS:c,navigate:p,user:r,openAddSubtaskModal:u,isEditModalOpen:d,closeEditModal:k,isAddSubtaskModalOpen:f,closeAddSubtaskModal:j,onAddSubtaskHandler:N,isQuestionModalOpen:T,closeQuestionModal:g,onDeleteTaskHandler:y,isStageModalOpen:M,closeStageModal:A}=X({task:e});return s.jsx("div",{className:n.task,children:s.jsxs("div",{className:n.content,children:[s.jsx("header",{className:n.header,children:s.jsxs("div",{className:n.headerInfo,children:[s.jsxs("div",{className:n.headerTop,children:[s.jsx(Q,{withAddition:!0,priority:e.priority}),s.jsx(D,{onClick:l}),o&&s.jsx(O,{className:`${n.popup}`,isClosing:i,handleClose:a,children:c.map(m=>m.map((_,h)=>s.jsx(P,{disabled:_.permission,className:h+1===m.length?"divider":"",icon:_.icon,title:_.title,handleClose:a,onClick:_.onClick},_.title)))}),s.jsx(B,{task:e,isEditModalOpen:d,closeEditModal:k,isAddSubtaskModalOpen:f,closeAddSubtaskModal:j,onAddSubtaskHandler:N,isQuestionModalOpen:T,closeQuestionModal:g,onDeleteTaskHandler:y,isStageModalOpen:M,closeStageModal:A})]}),s.jsxs("div",{onClick:()=>p(e._id),className:n.taskTitle,children:[s.jsx(V,{stage:e.stage}),s.jsx("h1",{className:n.title,children:e.title})]}),s.jsx("div",{className:n.date,children:$(new Date(e.date))})]})}),s.jsxs("main",{className:n.main,children:[s.jsxs("section",{className:n.details,children:[s.jsxs("article",{title:"Commentary",className:n.commentary,children:[s.jsx(v,{}),s.jsx("span",{children:e.activities.length})]}),s.jsxs("article",{title:"Assets",className:n.assets,children:[s.jsx(w,{}),s.jsx("span",{children:e.assets.length})]}),s.jsxs("article",{title:"Subtasks",className:n.subtasks,children:[s.jsx(E,{}),s.jsxs("span",{children:["0/",e.subTasks.length]})]})]}),s.jsx("section",{children:s.jsx(L,{infoClassName:n.userInfo,className:n.team,team:e.team})})]}),s.jsxs("footer",{className:n.footer,children:[s.jsx("section",{className:n.subtasksWrapper,children:e.subTasks.map((m,_)=>b.createElement(ts,{index:_,...m,key:m._id}))}),s.jsxs("button",{disabled:r.isAdmin,onClick:r.isAdmin&&u,className:`${n.btnAddSubtask} ${r.isAdmin?"":n.disabled}`,children:[s.jsx("span",{children:"+"})," ",s.jsx("p",{children:"Add subtask"})]})]})]})})},ys="_table_1jfay_1",Ms="_thead_1jfay_7",As="_tbody_1jfay_16",Ss="_tr_1jfay_21",Cs="_th_1jfay_7",x={table:ys,thead:Ms,tbody:As,tr:Ss,th:Cs},$s="_tr_102ss_1",Os="_td_102ss_25",vs="_capitalize_102ss_34",ws="_tableTitle_102ss_55",Es="_circle_102ss_66",Is="_title_102ss_72",Ds="_priority_102ss_77",Ps="_createdAt_102ss_89",Bs="_daysAgo_102ss_94",Ls="_details_102ss_98",Qs="_commentary_102ss_107",Vs="_assets_102ss_108",Fs="_subtasks_102ss_109",Hs="_subtasksWrapper_102ss_126",Ws="_team_102ss_147",zs="_actions_102ss_151",Rs="_editBtn_102ss_157",qs="_deleteBtn_102ss_168",t={tr:$s,td:Os,capitalize:vs,tableTitle:ws,circle:Es,title:Is,priority:Ds,createdAt:Ps,daysAgo:Bs,details:Ls,commentary:Qs,assets:Vs,subtasks:Fs,subtasksWrapper:Hs,team:Ws,actions:zs,editBtn:Rs,deleteBtn:qs},Ks=({task:e,navigateToTask:l})=>{const{isEditModalOpen:o,closeEditModal:i,isQuestionModalOpen:a,closeQuestionModal:c,openQuestionModal:p,openEditModal:r,handleToggle:u,isOpened:d,isClosing:k,closeAddSubtaskModal:f,handleClose:j,isAddSubtaskModalOpen:N,onAddSubtaskHandler:T,closeStageModal:g,isStageModalOpen:y,onDeleteTaskHandler:M,TASK_MORE_OPTIONS:A}=I({task:e}),{isDesktop:m}=F();return s.jsxs("tr",{className:t.tr,children:[s.jsxs("td",{onClick:()=>l(e._id),className:`${t.tableTitle} ${t.td}`,children:[s.jsx(V,{stage:e.stage}),s.jsx("h1",{className:t.title,children:e.title})]}),m?s.jsxs(s.Fragment,{children:[s.jsx("td",{className:`${t.priority} ${t.td}`,children:s.jsx(Q,{withAddition:!0,priority:e.priority})}),s.jsx("td",{className:`${t.td} ${t.createdAt} ${t.capitalize}`,children:s.jsx("span",{className:t.daysAgo,children:$(new Date(e.date))})}),s.jsxs("td",{className:`${t.td} ${t.details}`,children:[s.jsxs("article",{title:"Commentary",className:t.commentary,children:[s.jsx(v,{}),s.jsx("span",{children:e.activities.length})]}),s.jsxs("article",{title:"Assets",className:t.assets,children:[s.jsx(w,{}),s.jsx("span",{children:e.assets.length})]}),s.jsxs("article",{title:"Subtasks",className:t.subtasks,children:[s.jsx(E,{}),s.jsxs("span",{children:["0/",e.subTasks.length]})]})]}),s.jsx("td",{className:`${t.td}`,children:s.jsx(L,{infoClassName:t.userInfo,side:"left",className:t.team,team:e.team})}),s.jsxs("td",{className:`${t.actions} ${t.td} `,children:[s.jsx("button",{onClick:()=>r(e),className:t.editBtn,children:"Edit"}),s.jsx("button",{onClick:()=>p(e),className:t.deleteBtn,children:"Delete"})]})]}):s.jsxs("td",{className:t.more,children:[s.jsx(D,{onClick:()=>{u()}}),d&&s.jsx(O,{className:`${t.popup}`,isClosing:k,handleClose:j,children:A.map(_=>_.map((h,H)=>s.jsx(P,{disabled:h.permission,className:H+1===_.length?"divider":"",icon:h.icon,title:h.title,handleClose:j,onClick:h.onClick},h.title)))})]}),s.jsx(B,{task:e,isEditModalOpen:o,closeEditModal:i,isAddSubtaskModalOpen:N,closeAddSubtaskModal:f,onAddSubtaskHandler:T,isQuestionModalOpen:a,closeQuestionModal:c,onDeleteTaskHandler:M,isStageModalOpen:y,closeStageModal:g}),a&&s.jsx(q,{changedValue:a,onClose:c,task:e,type:"delete",text:"Are you sure you want to delete the selected task?",submitButtonText:"Delete"})]},e._id)},Us=({filteredTasks:e,titles:l,navigateToTask:o})=>{const{isDesktop:i}=F();return s.jsxs("table",{className:x.table,children:[s.jsx("thead",{className:x.thead,children:s.jsx("tr",{className:x.tr,children:i?l.map(a=>s.jsx("th",{className:`${x.th}`,children:a},a)):s.jsx("th",{className:x.th,children:l[0]})})}),s.jsx("tbody",{className:x.tbody,children:e.map(a=>s.jsx(Ks,{task:a,navigateToTask:o},a==null?void 0:a._id))})]})},Gs="_listView_ec274_1",Js="_notEmpty_ec274_12",C={listView:Gs,notEmpty:Js},Xs=["Task title","Priority","Created At","Assets","Team"],le=({tasks:e,stage:l})=>{const{isLoading:o,filteredTasks:i}=J({tasks:e,stage:l}),a=K(),c=b.useMemo(()=>({filteredTasks:i,titles:Xs,navigateToTask:a}),[i,a]);return s.jsx(U.section,{initial:"hidden",animate:"visible",variants:z,className:`${C.listView} ${i.length>0?C.notEmpty:""}`,children:o?s.jsx(R,{}):i.length>0?s.jsx(Us,{...c}):s.jsx("span",{className:C.notFound,children:"Tasks not found"})})};export{le as L,ie as T,J as u};
