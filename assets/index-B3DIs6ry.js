import{v as C,r as x,j as e,w as v,x as N,h as q}from"./index-BTjrKWUg.js";import{a as A,I as b,S as T,t as M}from"./transformToInputDateType-Q6j9lJDJ.js";import{M as B,T as S}from"./index-D6y65vRu.js";import{M as y,Q as F}from"./index-B-c8I1OG.js";const E="_dateTagBlock_5ucbp_1",D={dateTagBlock:E},P=({changedValue:t,onClose:s})=>{const{handleSubmit:a,reset:r,control:o}=C({mode:"onChange"}),{onSubmitHandler:n,onCloseHandler:l}=A({onClose:s,reset:r}),d=x.useCallback(()=>{},[]);return e.jsx(B,{changedValue:t,noCross:!0,onSubmit:d,onClose:l,children:e.jsx("section",{className:"modalWrapper",children:e.jsxs("form",{onSubmit:a(n),children:[e.jsx(S,{className:"modalTitle",children:"Add subtask"}),e.jsx(b,{name:"title",control:o,label:"Title",rules:{required:"Title is required"},placeholder:"Subtask title"}),e.jsxs("div",{className:D.dateTagBlock,children:[e.jsx(b,{name:"date",control:o,label:"Task date",type:"date",rules:{required:"Date is required"}}),e.jsx(b,{name:"tag",placeholder:"Tag",control:o,label:"Tag"})]}),e.jsx(y,{onSubmit:d,submitButtonText:"Add Task",onClose:l})]})})})},I=[{value:"todo",label:"TODO"},{value:"in progress",label:"IN PROGRESS"},{value:"completed",label:"COMPLETED"}],H=({changedValue:t,onClose:s,task:a})=>{const r=x.useMemo(()=>({stage:a!=null&&a.stage?{value:a.stage,label:a.stage.toUpperCase()}:""}),[a==null?void 0:a.stage]),{handleSubmit:o,reset:n,control:l}=C({mode:"onChange",defaultValues:r}),{onSubmitHandler:d,onCloseHandler:m}=A({onClose:s,reset:n}),c=x.useCallback(()=>{},[]);return e.jsx(B,{changedValue:t,noCross:!0,onSubmit:c,onClose:m,children:e.jsx("section",{className:"modalWrapper",children:e.jsxs("form",{onSubmit:o(d),children:[e.jsx(S,{className:"modalTitle",children:"Change task stage"}),e.jsx(T,{name:"stage",control:l,label:"Stage",rules:{required:"Stage is required"},placeholder:"Stage...",options:I}),e.jsx(y,{onSubmit:c,submitButtonText:"Submit",onClose:m})]})})})},L=({summary:t,task:s})=>{const a=x.useMemo(()=>{var u;return{name:(s==null?void 0:s.title)||"",assignee:((u=s==null?void 0:s.team)==null?void 0:u.map(j=>({value:j._id,label:j.name})))||"",stage:s!=null&&s.stage?{value:s.stage,label:s.stage.toUpperCase()}:"",priority:s!=null&&s.priority?{value:s.priority,label:s.priority.toUpperCase()}:"",date:s!=null&&s.date?M(s.date):"",assets:(s==null?void 0:s.assets)||[],description:(s==null?void 0:s.description)||"",links:s!=null&&s.links?s.links.join(","):""}},[s]),{handleSubmit:r,register:o,reset:n,control:l,setValue:d}=C({mode:"onChange",defaultValues:a}),[m,c]=x.useState(0),p=x.useMemo(()=>t.users.map(u=>({value:u._id,label:u.name})),[t.users]),g=x.useCallback(u=>{console.log(u.target.files),c(u.target.files.length)},[]),h=x.useCallback(()=>{},[]);return{users:p,handleSubmit:r,fileCount:m,register:o,control:l,handleFileChange:g,setValue:d,onSubmit:h,reset:n}},V="_label_dca6u_1",O="_textArea_dca6u_6",R="_textAreaError_dca6u_21",U="_errorText_dca6u_25",_={label:V,textArea:O,textAreaError:R,errorText:U},f=({name:t,control:s,label:a,rules:r,placeholder:o})=>{const{field:n,fieldState:{error:l}}=v({name:t,control:s,rules:r});return e.jsxs("div",{className:"inputBlock",children:[e.jsx("label",{className:_.label,children:a}),e.jsx("textarea",{...n,className:`${_.textArea} ${l?_.textAreaError:""}`,placeholder:o}),l&&e.jsx("p",{className:_.errorText,children:l.message})]})},$="_stagePriorityBlock_1e3f6_1",W="_dateAssetsBlock_1e3f6_2",w="_dateBlock_1e3f6_16",G="_stageBlock_1e3f6_17",Q="_priorityBlock_1e3f6_18",z="_addAssetsBlock_1e3f6_19",J="_inputFile_1e3f6_31",K="_addAssetsLabel_1e3f6_35",i={stagePriorityBlock:$,dateAssetsBlock:W,dateBlock:w,stageBlock:G,priorityBlock:Q,addAssetsBlock:z,inputFile:J,addAssetsLabel:K},X=[{value:"todo",label:"TODO"},{value:"in progress",label:"IN PROGRESS"},{value:"completed",label:"COMPLETED"}],Y=[{value:"low",label:"LOW"},{value:"normal",label:"NORMAL"},{value:"medium",label:"MEDIUM"},{value:"high",label:"HIGH"}],Z=({onClose:t,className:s,task:a,changedValue:r})=>{const{users:o,handleSubmit:n,control:l,register:d,handleFileChange:m,fileCount:c,reset:p,onSubmit:g}=L({summary:q,task:a}),{onCloseHandler:h,onSubmitHandler:u}=A({onClose:t,reset:p});return e.jsx(B,{changedValue:r,className:s,noCross:!0,onSubmit:g,onClose:h,children:e.jsxs("section",{className:"modalWrapper",children:[e.jsx(S,{className:"modalTitle",children:a?"Update task":"Add task"}),e.jsxs("form",{onSubmit:n(u),className:i.form,children:[e.jsx(b,{name:"name",control:l,label:"Task title",rules:{required:"Task title is required"},placeholder:"Title name"}),e.jsx(T,{name:"assignee",control:l,label:"Assign task to:",rules:{required:"Assign task to user is required"},options:o,isMulti:!0,placeholder:"Assign to..."}),e.jsxs("div",{className:i.stagePriorityBlock,children:[e.jsx("div",{className:i.stageBlock,children:e.jsx(T,{name:"stage",control:l,label:"Task stage",rules:{required:"Stage is required"},options:X,placeholder:"Stage..."})}),e.jsx("div",{className:i.priorityBlock,children:e.jsx(T,{name:"priority",control:l,label:"Priority level",rules:{required:"Priority is required"},options:Y,placeholder:"Priority..."})})]}),e.jsxs("div",{className:i.dateAssetsBlock,children:[e.jsx("div",{className:i.dateBlock,children:e.jsx(b,{name:"date",control:l,label:"Task date",type:"date",rules:{required:"Date is required"}})}),e.jsxs("div",{className:i.addAssetsBlock,children:[e.jsx("input",{type:"file",className:i.inputFile,id:"assets",...d("assets"),multiple:!0,onChange:j=>m(j)}),e.jsxs("label",{htmlFor:"assets",className:i.addAssetsLabel,children:[e.jsx(N,{className:i.addAssetsIcon}),e.jsxs("p",{className:i.addAssetsText,children:["Add assets",c>0&&e.jsxs("span",{children:[" (",c," files selected)"]})]})]})]})]}),e.jsx(f,{name:"description",control:l,label:"Task Description",placeholder:"Describe the task..."}),e.jsx(f,{name:"links",control:l,label:"Add links (separated by commas ',')",placeholder:"Add some links..."}),e.jsx(y,{onSubmit:g,onClose:h})]})]})})},ae=({task:t,isEditModalOpen:s,closeEditModal:a,isAddSubtaskModalOpen:r,closeAddSubtaskModal:o,onAddSubtaskHandler:n,isQuestionModalOpen:l,closeQuestionModal:d,onDeleteTaskHandler:m,isStageModalOpen:c,closeStageModal:p})=>e.jsxs(e.Fragment,{children:[s&&e.jsx(Z,{onClose:a,changedValue:s,task:t}),r&&e.jsx(P,{changedValue:r,onClose:o,onSubmit:n,taskId:t._id}),l&&e.jsx(F,{changedValue:l,onClose:d,task:t,onSubmit:m,type:"delete",text:"Are you sure you want to delete the selected task?",submitButtonText:"Delete"}),c&&e.jsx(H,{changedValue:c,onClose:p,onSubmit:p,task:t})]});export{ae as T,Z as a};
