import{p as O,q,v as F,I as P,w as k,x as D,j as e,y as S,r as x,z as H,A as L,h as R}from"./index-BUlJw_Qc.js";import{a as j,b as f,Q as $}from"./index-DR0zWF9G.js";import{u as V}from"./useTaskDetailHandler-BkDiA-iM.js";import{u as B,I as _,S as C,t as U}from"./transformToInputDateType-DdZGQ-re.js";import{M as y,T as M}from"./index-DwIwvJAb.js";const Te=({task:t})=>{const{isOpened:s,isClosing:o,handleToggle:a,handleClose:n}=O(),[r,l,i]=j({setItem:()=>{}}),[c,d,p]=j({setItem:()=>{}}),[b,g,u]=j({setItem:()=>{}}),[h,N,E]=j({setItem:()=>{}}),v=V();return{handleToggle:a,isOpened:s,isClosing:o,handleClose:n,TASK_MORE_OPTIONS:[[{icon:{Icon:q,color:"#000"},title:"Open task",permission:!1,onClick:()=>v(t._id)},{icon:{Icon:F,color:"#000"},title:"Edit",permission:!1,onClick:l},{icon:{Icon:P,color:"#000"},title:"Add sub task",permission:!1,onClick:g},{icon:{Icon:k,color:"#000"},title:"Change stage",permission:!1,onClick:N}],[{icon:{Icon:D,color:"red"},title:"Delete",permission:!1,onClick:d}]],navigate:v,openAddSubtaskModal:g,isEditModalOpen:r,closeEditModal:i,isAddSubtaskModalOpen:b,closeAddSubtaskModal:u,isQuestionModalOpen:c,closeQuestionModal:p,isStageModalOpen:h,openStageModal:N,closeStageModal:E}},Q="_item_1k9bl_1",W="_icon_1k9bl_17",w="_title_1k9bl_21",A={item:Q,icon:W,title:w},Ce=({icon:t,title:s,className:o,disabled:a,onClick:n,handleClose:r})=>{const{Icon:l,color:i}=t,c=()=>{r(),n()};return e.jsxs("button",{onClick:!a&&c,disabled:a,className:`${A.item} ${o}`,children:[e.jsx(l,{style:{color:i},className:A.icon}),e.jsx("p",{className:A.title,children:s})]})},G="_dateTagBlock_5ucbp_1",K={dateTagBlock:G},z=({changedValue:t,onClose:s})=>{const{handleSubmit:o,reset:a,control:n}=S({mode:"onChange"}),{onSubmitHandler:r,onCloseHandler:l}=B({onClose:s,reset:a}),i=x.useCallback(()=>{},[]);return e.jsx(y,{changedValue:t,noCross:!0,onSubmit:i,onClose:l,children:e.jsx("section",{className:"modalWrapper",children:e.jsxs("form",{onSubmit:o(r),children:[e.jsx(M,{className:"modalTitle",children:"Add subtask"}),e.jsx(_,{name:"title",control:n,label:"Title",rules:{required:"Title is required"},placeholder:"Subtask title"}),e.jsxs("div",{className:K.dateTagBlock,children:[e.jsx(_,{name:"date",control:n,label:"Task date",type:"date",rules:{required:"Date is required"}}),e.jsx(_,{name:"tag",placeholder:"Tag",control:n,label:"Tag"})]}),e.jsx(f,{onSubmit:i,submitButtonText:"Add Task",onClose:l})]})})})},J=[{value:"todo",label:"TODO"},{value:"in progress",label:"IN PROGRESS"},{value:"completed",label:"COMPLETED"}],X=({changedValue:t,onClose:s,task:o})=>{const a=x.useMemo(()=>({stage:o!=null&&o.stage?{value:o.stage,label:o.stage.toUpperCase()}:""}),[o==null?void 0:o.stage]),{handleSubmit:n,reset:r,control:l}=S({mode:"onChange",defaultValues:a}),{onSubmitHandler:i,onCloseHandler:c}=B({onClose:s,reset:r}),d=x.useCallback(()=>{},[]);return e.jsx(y,{changedValue:t,noCross:!0,onSubmit:d,onClose:c,children:e.jsx("section",{className:"modalWrapper",children:e.jsxs("form",{onSubmit:n(i),children:[e.jsx(M,{className:"modalTitle",children:"Change task stage"}),e.jsx(C,{name:"stage",control:l,label:"Stage",rules:{required:"Stage is required"},placeholder:"Stage...",options:J}),e.jsx(f,{onSubmit:d,submitButtonText:"Submit",onClose:c})]})})})},Y=({summary:t,task:s})=>{const o=x.useMemo(()=>{var u;return{name:(s==null?void 0:s.title)||"",assignee:((u=s==null?void 0:s.team)==null?void 0:u.map(h=>({value:h._id,label:h.name})))||"",stage:s!=null&&s.stage?{value:s.stage,label:s.stage.toUpperCase()}:"",priority:s!=null&&s.priority?{value:s.priority,label:s.priority.toUpperCase()}:"",date:s!=null&&s.date?U(s.date):"",assets:(s==null?void 0:s.assets)||[],description:(s==null?void 0:s.description)||"",links:s!=null&&s.links?s.links.join(","):""}},[s]),{handleSubmit:a,register:n,reset:r,control:l,setValue:i}=S({mode:"onChange",defaultValues:o}),[c,d]=x.useState(0),p=x.useMemo(()=>t.users.map(u=>({value:u._id,label:u.name})),[t.users]),b=x.useCallback(u=>{console.log(u.target.files),d(u.target.files.length)},[]),g=x.useCallback(()=>{},[]);return{users:p,handleSubmit:a,fileCount:c,register:n,control:l,handleFileChange:b,setValue:i,onSubmit:g,reset:r}},Z="_label_dca6u_1",ee="_textArea_dca6u_6",se="_textAreaError_dca6u_21",le="_errorText_dca6u_25",T={label:Z,textArea:ee,textAreaError:se,errorText:le},I=({name:t,control:s,label:o,rules:a,placeholder:n})=>{const{field:r,fieldState:{error:l}}=H({name:t,control:s,rules:a});return e.jsxs("div",{className:"inputBlock",children:[e.jsx("label",{className:T.label,children:o}),e.jsx("textarea",{...r,className:`${T.textArea} ${l?T.textAreaError:""}`,placeholder:n}),l&&e.jsx("p",{className:T.errorText,children:l.message})]})},oe="_stagePriorityBlock_1e3f6_1",te="_dateAssetsBlock_1e3f6_2",ae="_dateBlock_1e3f6_16",ne="_stageBlock_1e3f6_17",re="_priorityBlock_1e3f6_18",ie="_addAssetsBlock_1e3f6_19",ce="_inputFile_1e3f6_31",de="_addAssetsLabel_1e3f6_35",m={stagePriorityBlock:oe,dateAssetsBlock:te,dateBlock:ae,stageBlock:ne,priorityBlock:re,addAssetsBlock:ie,inputFile:ce,addAssetsLabel:de},ue=[{value:"todo",label:"TODO"},{value:"in progress",label:"IN PROGRESS"},{value:"completed",label:"COMPLETED"}],me=[{value:"low",label:"LOW"},{value:"normal",label:"NORMAL"},{value:"medium",label:"MEDIUM"},{value:"high",label:"HIGH"}],pe=({onClose:t,className:s,task:o,changedValue:a})=>{const{users:n,handleSubmit:r,control:l,register:i,handleFileChange:c,fileCount:d,reset:p,onSubmit:b}=Y({summary:R,task:o}),{onCloseHandler:g,onSubmitHandler:u}=B({onClose:t,reset:p});return e.jsx(y,{changedValue:a,className:s,noCross:!0,onSubmit:b,onClose:g,children:e.jsxs("section",{className:"modalWrapper",children:[e.jsx(M,{className:"modalTitle",children:o?"Update task":"Add task"}),e.jsxs("form",{onSubmit:r(u),className:m.form,children:[e.jsx(_,{name:"name",control:l,label:"Task title",rules:{required:"Task title is required"},placeholder:"Title name"}),e.jsx(C,{name:"assignee",control:l,label:"Assign task to:",rules:{required:"Assign task to user is required"},options:n,isMulti:!0,placeholder:"Assign to..."}),e.jsxs("div",{className:m.stagePriorityBlock,children:[e.jsx("div",{className:m.stageBlock,children:e.jsx(C,{name:"stage",control:l,label:"Task stage",rules:{required:"Stage is required"},options:ue,placeholder:"Stage..."})}),e.jsx("div",{className:m.priorityBlock,children:e.jsx(C,{name:"priority",control:l,label:"Priority level",rules:{required:"Priority is required"},options:me,placeholder:"Priority..."})})]}),e.jsxs("div",{className:m.dateAssetsBlock,children:[e.jsx("div",{className:m.dateBlock,children:e.jsx(_,{name:"date",control:l,label:"Task date",type:"date",rules:{required:"Date is required"}})}),e.jsxs("div",{className:m.addAssetsBlock,children:[e.jsx("input",{type:"file",className:m.inputFile,id:"assets",...i("assets"),multiple:!0,onChange:h=>c(h)}),e.jsxs("label",{htmlFor:"assets",className:m.addAssetsLabel,children:[e.jsx(L,{className:m.addAssetsIcon}),e.jsxs("p",{className:m.addAssetsText,children:["Add assets",d>0&&e.jsxs("span",{children:[" (",d," files selected)"]})]})]})]})]}),e.jsx(I,{name:"description",control:l,label:"Task Description",placeholder:"Describe the task..."}),e.jsx(I,{name:"links",control:l,label:"Add links (separated by commas ',')",placeholder:"Add some links..."}),e.jsx(f,{onSubmit:b,onClose:g})]})]})})},Ae=({task:t,isEditModalOpen:s,closeEditModal:o,isAddSubtaskModalOpen:a,closeAddSubtaskModal:n,onAddSubtaskHandler:r,isQuestionModalOpen:l,closeQuestionModal:i,onDeleteTaskHandler:c,isStageModalOpen:d,closeStageModal:p})=>e.jsxs(e.Fragment,{children:[s&&e.jsx(pe,{onClose:o,changedValue:s,task:t}),a&&e.jsx(z,{changedValue:a,onClose:n,onSubmit:r,taskId:t._id}),l&&e.jsx($,{changedValue:l,onClose:i,task:t,onSubmit:c,type:"delete",text:"Are you sure you want to delete the selected task?",submitButtonText:"Delete"}),d&&e.jsx(X,{changedValue:d,onClose:p,onSubmit:p,task:t})]});export{Ce as P,Ae as T,pe as a,Te as u};
